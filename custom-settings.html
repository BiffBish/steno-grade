<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Steno Grade</title>
    <link href="style.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="font-roboto.css">
    <script src="utils/util.js"></script>
</head>

<body>

    <h1 class="center title">Custom Settings</h1>

    <!-- A code block with the current settings -->


    <div id="form" class="wrapper">
        <div class="form-section">
            <div class="caption">Current Settings</div>
            <div class="code-block">
                <pre><code id="current-settings"></code></pre>
            </div>
            <div class="caption red">Custom Settings</div>
            <pre><code id="custom-settings" class="red"></code></pre>

        </div>
        <!-- two inputs that aloow you to enter your own custom key value pairs -->
        <div class="form-section">
            <div class="caption">Custom Settings</div>
            <div class="code-block">
                <pre><code id="custom-settings"></code></pre>
            </div>
            <input type="text" style="width:80%" id="custom-settings-input" placeholder="key=value, key (to remove)">
            <button id="custom-settings-button">Add</button>
            <br />
            <br />
            <button id="custom-settings-reset">Reset All To Default</button>
        </div>
    </div>

    </div>

    </div>

    <script>

        setTheme()
        //Get the current settings from local storage and pretty print them in the code block
        var currentSettings = JSON.parse(localStorage.getItem("settings"))

        var currentSettingsString = JSON.stringify(currentSettings, null, 2)
        document.getElementById("current-settings").innerHTML = currentSettingsString


        var customSettings = JSON.parse(localStorage.getItem("custom_settings") ?? "{}")
        var customSettingsString = JSON.stringify(customSettings, null, 2)
        document.getElementById("custom-settings").innerHTML = customSettingsString

        //Add a listener to the custom settings button that adds the key value pair to the current settings
        document.getElementById("custom-settings-button").addEventListener("click", function () {

            var customSettingsInputString = document.getElementById("custom-settings-input").value
            var customSettingsArray = customSettingsInputString.split("=")
            var key = customSettingsArray[0]
            var value = customSettingsArray[1]
            customSettings[key] = value
            console.log(customSettings)
            localStorage.setItem("custom_settings", JSON.stringify(customSettings))
            var currentSettingsString = JSON.stringify(customSettings, null, 2)
            document.getElementById("custom-settings").innerHTML = currentSettingsString




            setTheme()

        })

        //Add a listener to the reset button that resets all settings to default
        document.getElementById("custom-settings-reset").addEventListener("click", function () {
            //alert to make sure
            if (confirm("Are you sure you want to reset all settings to default?")) {
                localStorage.setItem("custom_settings", JSON.stringify({}))
                var customSettingsString = JSON.stringify({}, null, 2)
                document.getElementById("custom-settings").innerHTML = customSettingsString
                setTheme()
            }
        })
        var input = document.getElementById("custom-settings-input");
        input.addEventListener("keyup", function (event) {
            if (event.keyCode === 13) {
                event.preventDefault();
                document.getElementById("custom-settings-button").click();
            }
        });
    </script>
</body>